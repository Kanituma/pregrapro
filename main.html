<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" />
</head>
<body>
    <div id="loading">
        <div class="loader" title="6">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="24px" height="30px" viewBox="0 0 24 30" style="enable-background:new 0 0 50 50;" xml:space="preserve">
            <rect x="0" y="0" width="5" height="25" fill="#333">
                <animate attributeName="opacity" attributeType="XML"
                values="1; .2; 1" 
                begin="0s" dur="0.6s" repeatCount="indefinite" />
            </rect>
            <rect x="10" y="0" width="5" height="25" fill="#333">
                <animate attributeName="opacity" attributeType="XML"
                values="1; .2; 1" 
                begin="0.2s" dur="0.6s" repeatCount="indefinite" />
            </rect>
            <rect x="20" y="0" width="5" height="25" fill="#333">
                <animate attributeName="opacity" attributeType="XML"
                values="1; .2; 1" 
                begin="1.4s" dur="0.6s" repeatCount="indefinite" />
            </rect>
            </svg>
        </div>
    </div>
    <!-- <div id="load"></div> -->
    <div class="page1">
        <div id="opbtn"></div>
        <div id="open"></div>
    </div>
    <div class="white"></div>
    <div class="page2">
            <div class="slide one rellax" data-rellax-speed="5" >
                <span class="one-r"></span>
                <div class="img img-b ione">
                    <img src="images/p1.png" class="pic-b">
                </div>
                <img src="images/light-b.png" class="light lone rellax" data-rellax-speed="1">
                <img src="images/bar1.png" class="plant pone rellax" data-rellax-speed="1.3">
            </div>
            
            <div class="slide two rellax" data-rellax-speed="3">
                <div class="img img-s itwo">
                    <img src="images/p2.png" class="pic-s">
                </div>
                <img src="images/light-s.png" class="light ltwo rellax" data-rellax-speed="0.5">
                 <img src="images/plant2.png" class="plant ptwo rellax" data-rellax-speed="0.8">
            </div>
           
            <div class="slide three rellax" data-rellax-speed="5">
                <span class="three-r"></span>
                <div class="img img-b ithree">
                    <img src="images/p3.png" class="pic-b">
                </div>
                <img src="images/light-b.png" class="light lthree rellax" data-rellax-speed="1">
                 <img src="images/chair3.png" class="plant pthree rellax" data-rellax-speed="1.3">
            </div>
           
            <div class="slide four rellax" data-rellax-speed="4">
                <div class="img img-s ifour">
                    <img src="images/p4.png" class="pic-s">
                </div>
                <img src="images/light-s.png" class="light lfour rellax" data-rellax-speed="0.8">
                 <img src="images/plant4.png" class="plant pfour rellax" data-rellax-speed="0.8">
            </div>
           
            <div class="slide five rellax" data-rellax-speed="6">
                <span class="five-r"></span>
                <div class="img img-b ifive">
                    <img src="images/p5.png" class="pic-b">
                </div>
                <img src="images/light-b.png" class="light lfive rellax" data-rellax-speed="1">
                <img src="images/cat5.png" class="plant pfive rellax" data-rellax-speed="0.8">
            </div>
            
            <div class="slide six rellax" data-rellax-speed="4" id="ssix">
                <div class="img img-s isix">
                    <img src="images/p6.png" class="pic-s">
                </div>
                <img src="images/light-s.png" class="light lsix rellax" data-rellax-speed="0.5">
            </div>
            <!-- <div class="slide seven rellax" data-rellax-speed="4" >
            </div> -->
            <div id="flrdiv" class="rellax" data-rellax-speed="5">
                <div id="floor"></div>
            </div>
    </div>   
</body>
<script src="js/rellax.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.0/jquery.js"></script>
<script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
<script>

// window.addEventListener("load",muApp,false)
// window.onload = function(){
var queue = new createjs.LoadQueue(false);
queue.on("progress",event =>{
    console.log("loading...")
    $("#loading").css("transition","2s")
})
queue.on("complete",event =>{
    // MuApp();
    
})
queue.on("fileload",MuApp)
//大于500k的预加载
queue.loadFile("images/sprite.jpg")
queue.loadFile("images/floor.png")
queue.loadFile("images/wall4.png")
queue.loadFile("images/wall2.png")
queue.loadFile("images/wall6.png")
queue.loadFile("images/wall5.png")
function MuApp(){
    console.log("OKok")
    $("#loading").css("opacity","0");
    var h = $(window).height();
    var times = h / 640;
    console.log(times)
    
    $("#open").css("transform","translate(-50%,-50%) scale("+times+")")
    // $("#open").css("animation","anim1 5s 2s steps(84) both")
    $("#open").css("animation","anim1 5s 2s steps(76) both")
    
    
    
    
    
    var flag = true;
     setInterval(function(){
        
        $('#open').on('animationend webkitAnimationEnd', function() { 
            if(flag == true){
                // $("#loading").css("display","none");
                $("#opbtn").css("opacity","1");
                setTimeout(function(){
                    flag = false;
                },200)
                console.log(flag)
            }
            if(flag == false){
                    // $(".page2").css("display","block")
                    
                    $(".white").css("opacity","0")
                    $(".page1").css("display","none")
                    
            }
             
        });
        console.log(flag)
    },100)
    $("#opbtn").click(function(){
        console.log("点啦")
        // $("#open").css("animation","anim2 1s 1s steps(23) both")
        $("#open").css("animation","anim2 1s 1s steps(17) both")
        // console.log(flag);
        $("#opbtn").css("opacity","0")
    })
    var rellax = new Rellax('.rellax', {
        speed: -2,
        center: false,
        wrapper: null,
        round: true,
        vertical: false,
        horizontal: true
    })
    $(document).scroll(function() {
        var w = $("#ssix").offset().left + $("#ssix").width()
        $(".page2").css("width",w)
        console.log(w)
    })
    
    $(".img").click(function(){
        $(".comment").removeClass("close")
        $(".comment").addClass("open")
        
    })
}

</script>

</html>
  